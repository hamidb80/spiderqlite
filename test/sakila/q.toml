[queries]

5conds = '''
  #person      p  
  #acted_in    a  
  #directed_by d
  #movie       m

  match  
    p>-a->m<-!d-<p

  return
    p
'''

get_agg = '''
  #person   p  
  @acted_in a  
  #movie    m

  match  
    p>-a->^m

  AS
    len_actors
    ()
      COUNT
      p
        .id

    collected_actor_names
    [].
      p
        .name

    is_12
    CASE
      when 
        ==
          len_actors
          12
        "YES"
      else
        "NO"

  GROUP BY
    m
      .id

  HAVING
    <= 
      10
      len_actors

  LIMIT 
    10
  OFFSET 
    1

  ORDER BY
    len_actors
  SORT 
    DESC

  return
    {}
      "movie_title"
      m
        .title

      "has 12 actors"
      is_12

      "number_of_actors"
      len_actors

      "actors"
      collected_actor_names
'''

get = '''
  -- or can be #: p, since it doesn't matter

  #person   p  
  @acted_in a  
  #movie    m
    == 
      .title 
      |mtitle|

  match  ^m<-a<-p
  return p
'''

simple1 = '''
  #movie    m
    == 
      .title 
      |mtitle|

  FROM   m
  SELECT m
'''

use_named = '''
  #movie    m
  #person   p
  @acted_in a

  USE       single-edge-node-head
  PARAMS    p m a
  RETURN    p
  LIMIT     1
'''